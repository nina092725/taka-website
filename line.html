<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>好きなエンタメ</title>
    <link rel="stylesheet" href="banana-slip.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #abced8;
            font-family: 'Rounded Mplus 1c', 'Arial', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }
        .header {
            position: absolute;
            left: 50%;
            top: 15vh;
            transform: translateX(-50%);
            z-index: 10;
            font-family: 'Banana Slip', 'Rounded Mplus 1c', 'Arial', sans-serif;
            font-size: 4.5em;
            color: #660033;
            letter-spacing: 0.08em;
            text-shadow: 2px 2px 0 #fffbe7, 0 4px 12px #ffd70044;
            background: none;
            border-radius: 0;
            padding: 0;
            box-shadow: none;
            text-align: center;
            justify-content: center;
            align-items: center;
            display: flex;
        }
        @media (max-width: 600px) {
            .header { font-size: 3em; top: 7vh; justify-content:center; align-items:center; display:flex; }
            .main { padding: 0 2vw; text-align: center; }
            body { text-align: center !important; }
        }
        @media (max-width: 400px) {
            .header { font-size: 1em; top: 4vh; }
            .main { padding: 0 1vw; }
        }
        .main {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
        }
        .entame {
            margin-top: 32vh;
            width: 80vw;
            max-width: 800px;
            background: #fffbe7;
            border-radius: 18px;
            box-shadow: 0 4px 16px #66003322;
            padding: 32px;
        }
        .entame-title {
            font-family: 'Banana Slip', 'Rounded Mplus 1c', 'Arial', sans-serif;
            font-size: 2em;
            color: #660033;
            margin-bottom: 24px;
            text-align: center;
        }
        .entame-list {
            font-size: 1.1em;
            color: #333;
            line-height: 2;
        }
        .entame-list a {
            color: #660033;
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="header">好きなエンタメ</div>
    <div class="main">
        <div class="entame">
            <div class="entame-title">おすすめエンタメ</div>
            <ul class="entame-list">
                <li><a href="https://www.tbsradio.jp/" target="_blank">TBSラジオ</a></li>
                <li><a href="https://www.youtube.com/" target="_blank">YouTube</a></li>
                <li><a href="https://www.netflix.com/jp/" target="_blank">Netflixドラマ</a></li>
            </ul>
            <div style="margin-top:32px;text-align:center;">
                <!-- プレイヤー（IFrame APIで制御） -->
                <div id="player" style="width:100%;max-width:900px;margin:0 auto;"></div>
                <!-- プレイリストのサムネ一覧 -->
                <div id="playlistList" style="margin-top:18px;display:flex;flex-wrap:wrap;gap:12px;justify-content:center;"></div>
            </div>
            <script>
                const playlistId = 'PL_0HRbJsBYMbgkg4WlKMG0kvKIdbJQZYL';
                // 1) YouTube IFrame APIを読み込む
                let tag = document.createElement('script');
                tag.src = "https://www.youtube.com/iframe_api";
                document.body.appendChild(tag);

                let player;
                function onYouTubeIframeAPIReady() {
                    player = new YT.Player('player', {
                        height: '360',
                        width: '100%',
                        playerVars: {
                            listType: 'playlist',
                            list: playlistId,
                            modestbranding: 1,
                            rel: 0
                        },
                        events: {
                            'onReady': onPlayerReady
                        }
                    });
                }

                function onPlayerReady(event) {
                    // プレイリストIDで初期化されたプレイヤーから動画一覧を取得
                    // 少し待ってから取得（読み込み完了を待つ）
                    setTimeout(buildPlaylistFromPlayer, 800);
                }

                function buildPlaylistFromPlayer() {
                    if (!player) return;
                    let ids = player.getPlaylist();
                    if (!ids || !ids.length) {
                        // 取得できない場合はiframeのembedを利用したシンプルリンクのみ表示
                        const listEl = document.getElementById('playlistList');
                        listEl.innerHTML = '<div>プレイリスト情報を取得できませんでした。</div>';
                        return;
                    }
                    const listEl = document.getElementById('playlistList');
                    listEl.innerHTML = '';
                    ids.forEach((vid, idx) => {
                        const item = document.createElement('div');
                        item.className = 'playlist-item';
                        item.style.width = '160px';
                        item.style.cursor = 'pointer';
                        item.style.textAlign = 'center';

                        const a = document.createElement('a');
                        a.href = '#';
                        a.dataset.index = idx;
                        a.style.textDecoration = 'none';
                        a.style.color = '#333';

                        const img = document.createElement('img');
                        img.src = `https://i.ytimg.com/vi/${vid}/hqdefault.jpg`;
                        img.alt = 'thumb';
                        img.style.width = '100%';
                        img.style.borderRadius = '8px';

                        const titleDiv = document.createElement('div');
                        titleDiv.textContent = vid;
                        titleDiv.style.fontSize = '0.9em';
                        titleDiv.style.marginTop = '6px';
                        titleDiv.style.color = '#660033';

                        a.appendChild(img);
                        a.appendChild(titleDiv);
                        a.addEventListener('click', (e) => {
                            e.preventDefault();
                            const index = parseInt(a.dataset.index, 10);
                            if (player && typeof player.playVideoAt === 'function') {
                                player.playVideoAt(index);
                            } else if (player && typeof player.cuePlaylist === 'function') {
                                player.cuePlaylist(ids, index);
                            }
                        });

                        item.appendChild(a);
                        listEl.appendChild(item);

                        // タイトルをoEmbedで補完（できれば）
                        fetch(`https://www.youtube.com/oembed?url=https://www.youtube.com/watch?v=${vid}&format=json`)
                            .then(r => r.json())
                            .then(json => {
                                titleDiv.textContent = json.title;
                            }).catch(()=>{
                                // 失敗してもID表示のままにする
                            });
                    });
                }
            </script>
        </div>
    </div>
</body>
</html>
